% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SNPData-class.R
\docType{class}
\name{SNPData-class}
\alias{SNPData-class}
\alias{[,SNPData,ANY,ANY,ANY-method}
\alias{SNPData}
\alias{SNPData,Matrix,Matrix,data.frame,data.frame-method}
\alias{ref_count}
\alias{ref_count,SNPData-method}
\alias{alt_count}
\alias{alt_count,SNPData-method}
\alias{oth_count}
\alias{oth_count,SNPData-method}
\alias{get_snp_info}
\alias{get_snp_info,SNPData-method}
\alias{get_barcode_info}
\alias{get_barcode_info,SNPData-method}
\alias{get_sample_info}
\alias{get_sample_info,SNPData-method}
\alias{dim,SNPData-method}
\alias{nrow,SNPData-method}
\alias{ncol,SNPData-method}
\alias{rownames,SNPData-method}
\alias{colnames,SNPData-method}
\alias{show,SNPData-method}
\alias{coverage}
\alias{coverage,SNPData-method}
\title{SNPData: S4 class for single-cell SNP count data}
\usage{
\S4method{[}{SNPData,ANY,ANY,ANY}(x, i, j)

SNPData(ref_count, alt_count, snp_info, barcode_info, oth_count = NULL)

\S4method{SNPData}{Matrix,Matrix,data.frame,data.frame}(ref_count, alt_count, snp_info, barcode_info, oth_count = NULL)

ref_count(x)

\S4method{ref_count}{SNPData}(x)

alt_count(x)

\S4method{alt_count}{SNPData}(x)

oth_count(x)

\S4method{oth_count}{SNPData}(x)

get_snp_info(x)

\S4method{get_snp_info}{SNPData}(x)

get_barcode_info(x)

\S4method{get_barcode_info}{SNPData}(x)

get_sample_info(x)

\S4method{get_sample_info}{SNPData}(x)

\S4method{dim}{SNPData}(x)

\S4method{nrow}{SNPData}(x)

\S4method{ncol}{SNPData}(x)

\S4method{rownames}{SNPData}(x)

\S4method{colnames}{SNPData}(x)

\S4method{show}{SNPData}(object)

coverage(x)

\S4method{coverage}{SNPData}(x)
}
\arguments{
\item{x}{A SNPData object}

\item{i}{Numeric or logical vector for subsetting SNPs (rows)}

\item{j}{Numeric or logical vector for subsetting samples (columns)}

\item{ref_count}{A sparse Matrix containing reference allele counts (SNPs x cells)}

\item{alt_count}{A sparse Matrix containing alternate allele counts (SNPs x cells)}

\item{snp_info}{A data.frame containing SNP metadata}

\item{barcode_info}{A data.frame containing cell/barcode metadata}

\item{oth_count}{A sparse Matrix containing other allele counts (SNPs x cells), optional}

\item{object}{A SNPData object for show method}
}
\value{
A subsetted SNPData object

A numeric vector of length 2 giving the number of SNPs and samples
}
\description{
An S4 class to store and manipulate single-cell SNP count matrices with associated metadata.
This class integrates reference/alternate allele count matrices, SNP information, and
cell/barcode metadata to support allele-specific expression analysis workflows.
}
\section{Slots}{

\describe{
\item{\code{ref_count}}{A sparse Matrix containing reference allele counts (SNPs x cells)}

\item{\code{alt_count}}{A sparse Matrix containing alternate allele counts (SNPs x cells)}

\item{\code{oth_count}}{A sparse Matrix containing other allele counts (SNPs x cells)}

\item{\code{snp_info}}{A data.frame containing SNP metadata with automatically computed coverage and non_zero_samples columns}

\item{\code{barcode_info}}{A data.frame containing cell/barcode metadata with automatically computed library_size and non_zero_snps columns}
}}

\section{Accessors}{

\describe{
  \item{\code{ref_count(x)}}{Get reference allele count matrix}
  \item{\code{alt_count(x)}}{Get alternate allele count matrix}
  \item{\code{oth_count(x)}}{Get other allele count matrix}
  \item{\code{get_snp_info(x)}}{Get SNP metadata data.frame}
  \item{\code{get_barcode_info(x)}}{Get cell/barcode metadata data.frame}
  \item{\code{get_sample_info(x)}}{Alias for get_barcode_info()}
  \item{\code{coverage(x)}}{Get total coverage matrix (ref + alt counts)}
}
}

\section{Dimensions}{

\describe{
  \item{\code{nrow(x)}, \code{ncol(x)}, \code{dim(x)}}{Get object dimensions}
  \item{\code{rownames(x)}, \code{colnames(x)}}{Get row/column names (SNP/cell IDs)}
}
}

\section{Note}{

The class automatically computes summary statistics in metadata:
\itemize{
  \item \code{snp_info$coverage}: Total counts per SNP across all cells
  \item \code{snp_info$non_zero_samples}: Number of cells with non-zero counts per SNP
  \item \code{barcode_info$library_size}: Total counts per cell across all SNPs
  \item \code{barcode_info$non_zero_snps}: Number of SNPs with non-zero counts per cell
}
}

\examples{
\dontrun{
# Create SNPData object
snp_data <- SNPData(
  ref_count = ref_matrix,
  alt_count = alt_matrix,
  snp_info = snp_df,
  barcode_info = cell_df
)

# Access count matrices
ref_counts <- ref_count(snp_data)
alt_counts <- alt_count(snp_data)

# Access metadata
snp_metadata <- get_snp_info(snp_data)
cell_metadata <- get_barcode_info(snp_data)

# Calculate derived metrics
total_coverage <- coverage(snp_data)
}

}
