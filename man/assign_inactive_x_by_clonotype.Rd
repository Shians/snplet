% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/assign_inactive_x.R
\name{assign_inactive_x_by_clonotype}
\alias{assign_inactive_x_by_clonotype}
\alias{assign_inactive_x_by_clonotype,SNPData-method}
\title{Assign inactive X chromosome to cells by clonotype}
\usage{
assign_inactive_x_by_clonotype(x)

\S4method{assign_inactive_x_by_clonotype}{SNPData}(x)
}
\arguments{
\item{x}{SNPData object containing X chromosome SNP data with donor
assignments, clonotype information, and heterozygosity information}
}
\value{
SNPData object with an additional \code{inactive_x} column in
  barcode metadata, with values "X1" or "X2" indicating the inferred
  inactive X chromosome state
}
\description{
Identifies which X chromosome is inactive in female cells based on allelic
imbalance patterns at heterozygous SNPs, aggregating to the clonotype level
before assigning and then projecting back to individual cells.
}
\details{
This function is similar to \code{\link{assign_inactive_x}} but performs
clustering at the clonotype level rather than the cell level. This approach:
\itemize{
  \item Increases statistical power by aggregating counts across clonally related cells
  \item Reduces noise from sparse cell-level data
  \item Is biologically motivated since clonally related cells should share X-inactivation state
}

The algorithm works as follows:
\enumerate{
  \item Filters to heterozygous SNPs on the X chromosome for each donor
  \item Selects the SNP with highest coverage per gene to avoid redundancy
  \item Aggregates ALT and REF counts by clonotype
  \item Identifies informative SNPs with sufficient coverage across clonotypes
  \item Computes an expression-like matrix capturing allelic imbalance at clonotype level
  \item Performs hierarchical clustering on the sign of allelic imbalance
  \item Assigns clonotypes to two clusters (X1 or X2) representing inactive X states
  \item Projects clonotype assignments back to individual cells
}
}
\examples{
\dontrun{
# Assign inactive X chromosome to cells by clonotype
snp_data <- assign_inactive_x_by_clonotype(snp_data)

# View results
get_barcode_info(snp_data) \%>\%
  count(donor, clonotype, inactive_x)
}
}
