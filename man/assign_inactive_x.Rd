% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/assign_inactive_x.R
\name{assign_inactive_x}
\alias{assign_inactive_x}
\title{Assign Inactive X Chromosome}
\usage{
assign_inactive_x(x, snp_quantile = 0.9, cell_quantile = 0.8)
}
\arguments{
\item{x}{A SNPData object}

\item{snp_quantile}{Quantile threshold for SNP coverage filtering (default 0.9).
Only chrX SNPs with coverage >= this quantile are used for clustering.}

\item{cell_quantile}{Quantile threshold for cell library size filtering (default 0.8).
Only cells with library size >= this quantile are used for training the model.}
}
\value{
A SNPData object with added barcode metadata columns:
  \itemize{
    \item inactive_x: Predicted inactive X chromosome ("X1" or "X2")
    \item inactive_x_prob: Probability of the assignment (max of the two class probabilities)
  }
}
\description{
Infers which X chromosome is inactive in female cells based on allele-specific
expression patterns. Uses hierarchical clustering on high-coverage chrX SNPs
to identify two groups of cells with correlated expression patterns, then
fits a Gaussian Mixture Model to classify all cells.
}
\details{
The function follows these steps:
\enumerate{
  \item Filter to chrX SNPs with high coverage (>= snp_quantile)
  \item Filter to cells with high library size (>= cell_quantile)
  \item Convert to expression matrix using sign(REF-ALT) * log1p(|REF-ALT|)
  \item Cluster cells using hierarchical clustering (Ward's method) on correlation distance
  \item Cut dendrogram into 2 clusters
  \item Calculate cluster assignment scores for all cells
  \item Fit Gaussian Mixture Model on training scores
  \item Predict inactive X for all cells using the GMM
}
}
\examples{
\dontrun{
# Assign inactive X chromosome
snpdata <- assign_inactive_x(snpdata)

# View results
barcode_info <- get_barcode_info(snpdata)
table(barcode_info$inactive_x)

# Use more stringent filtering
snpdata <- assign_inactive_x(
    snpdata,
    snp_quantile = 0.95,
    cell_quantile = 0.9
)
}

}
