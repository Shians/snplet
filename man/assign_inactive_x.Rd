% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/assign_inactive_x.R
\name{assign_inactive_x}
\alias{assign_inactive_x}
\alias{assign_inactive_x,SNPData-method}
\title{Assign inactive X chromosome to cells}
\usage{
assign_inactive_x(x)

\S4method{assign_inactive_x}{SNPData}(x)
}
\arguments{
\item{x}{SNPData object containing X chromosome SNP data with donor
assignments and heterozygosity information}
}
\value{
SNPData object with an additional \code{inactive_x} column in
  barcode metadata, with values "X1" or "X2" indicating the inferred
  inactive X chromosome state
}
\description{
Identifies which X chromosome is inactive in female cells based on allelic
imbalance patterns at heterozygous SNPs. Uses hierarchical clustering to
assign cells into two groups representing the two possible X-inactivation
states.
}
\details{
X-chromosome inactivation (XCI) is a dosage compensation mechanism in female
mammals where one of the two X chromosomes is randomly silenced in each cell.
This function infers which X is inactive by analyzing allelic expression
patterns at heterozygous SNPs on the X chromosome.

The algorithm works as follows:
\enumerate{
  \item Filters to heterozygous SNPs on the X chromosome for each donor
  \item Selects the SNP with highest coverage per gene to avoid redundancy
  \item Identifies informative SNPs with sufficient coverage across cells
  \item Computes an expression-like matrix capturing allelic imbalance
  \item Performs hierarchical clustering on the sign of allelic imbalance
  \item Assigns cells to two clusters (X1 or X2) representing inactive X states
}

Cells within each cluster should show consistent allelic bias patterns,
reflecting which parental X chromosome is active vs. inactive.
}
\examples{
\dontrun{
# Assign inactive X chromosome to cells
snp_data <- assign_inactive_x(snp_data)

# View results
get_barcode_info(snp_data) \%>\%
  count(donor, inactive_x)
}
}
