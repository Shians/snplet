% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/assign_inactive_x.R
\name{plot_inactive_x_heatmap_by_clonotype}
\alias{plot_inactive_x_heatmap_by_clonotype}
\alias{plot_inactive_x_heatmap_by_clonotype,SNPData-method}
\title{Plot inactive X chromosome heatmap for a donor at clonotype level}
\usage{
plot_inactive_x_heatmap_by_clonotype(x, donor)

\S4method{plot_inactive_x_heatmap_by_clonotype}{SNPData}(x, donor)
}
\arguments{
\item{x}{SNPData object containing X chromosome SNP data with clonotype information}

\item{donor}{Character string specifying which donor to visualize}
}
\value{
A ComplexHeatmap object showing the inactive X clustering pattern at clonotype level
}
\description{
Visualizes allelic imbalance patterns at informative heterozygous SNPs to
reveal X-inactivation structure at the clonotype level. Clonotypes are
clustered based on their allelic bias signatures, which should separate into
two groups corresponding to the two inactive X states.
}
\details{
This function creates a heatmap showing the sign of allelic expression at
heterozygous SNPs across clonotypes from a single donor. The heatmap uses:
\itemize{
  \item Rows: Informative heterozygous SNPs on the X chromosome (one per gene)
  \item Columns: Clonotypes (aggregated from individual cells)
  \item Values: Sign of allelic imbalance (+1 for REF bias, -1 for ALT bias, 0 for balanced)
  \item Clustering: Hierarchical clustering with complete linkage and Euclidean distance
}

The clustering should reveal two main groups of clonotypes, each showing opposite
allelic bias patterns across SNPs. This bimodal pattern reflects which of the
two parental X chromosomes is inactive in cells from each clonotype.

Only SNPs with at least 2 reads coverage in at least 1% of clonotypes are included
to focus on informative loci. Counts are aggregated at the clonotype level before
computing allelic imbalance.
}
\examples{
\dontrun{
# Plot inactive X pattern for a specific donor at clonotype level
plot_inactive_x_heatmap_by_clonotype(snp_data, donor = "donor1")

# Save the plot
pdf("inactive_x_heatmap_clonotype.pdf", width = 10, height = 8)
plot_inactive_x_heatmap_by_clonotype(snp_data, donor = "donor1")
dev.off()
}
}
